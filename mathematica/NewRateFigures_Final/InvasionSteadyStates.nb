(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34018,        782]
NotebookOptionsPosition[     32838,        738]
NotebookOutlinePosition[     33195,        754]
CellTagsIndexPosition[     33152,        751]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nb1", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", 
       "\"\</Dropbox/PostDoc/2014_DiffusingForager/DiffusingForager/\
mathematica/NewRateFigures_Final/Ratesfunc.nb\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"nb1", ",", "All", ",", "Notebook"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionEvaluate", "[", "nb1", "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dF", " ", "=", 
   RowBox[{
    RowBox[{"\[Lambda]", "*", "F"}], "-", 
    RowBox[{"\[Sigma]", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "R"}], ")"}], "*", "F"}], " ", "+", 
    RowBox[{"\[Rho]", "*", 
     FractionBox["c", "k"], "*", " ", "R", " ", "*", " ", "H"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dH", " ", "=", 
   RowBox[{
    RowBox[{"\[Sigma]", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "R"}], ")"}], "*", "F"}], " ", "-", " ", 
    RowBox[{"\[Rho]", "*", 
     FractionBox["c", "k"], "*", " ", "R", "*", "H"}], " ", "-", " ", 
    RowBox[{"\[Mu]", "*", "H"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dFI", " ", "=", 
   RowBox[{
    RowBox[{"\[Lambda]I", "*", "FI"}], "-", 
    RowBox[{"\[Sigma]I", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "R"}], ")"}], "*", "FI"}], " ", "+", 
    RowBox[{"\[Rho]I", "*", 
     FractionBox["c", "k"], "*", " ", "R", " ", "*", " ", "HI"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dHI", "=", 
   RowBox[{
    RowBox[{"\[Sigma]I", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "R"}], ")"}], "*", "FI"}], " ", "-", " ", 
    RowBox[{"\[Rho]I", "*", 
     FractionBox["c", "k"], "*", " ", "R", "*", "HI"}], " ", "-", " ", 
    RowBox[{"\[Mu]I", "*", "HI"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dR", " ", "=", 
   RowBox[{
    RowBox[{"\[Alpha]", "*", "R", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "R"}], ")"}]}], " ", "-", 
    RowBox[{"\[Rho]", "*", "H", "*", "R"}], " ", "-", 
    RowBox[{"\[Delta]", "*", "H"}], "-", " ", 
    RowBox[{"\[Beta]", "*", "F"}], "-", 
    RowBox[{"\[Rho]I", "*", "HI", "*", "R"}], " ", "-", 
    RowBox[{"\[Delta]I", "*", "HI"}], "-", " ", 
    RowBox[{"\[Beta]I", "*", "FI"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696445810615947*^9, 3.696445992863496*^9}, {
   3.696446046946095*^9, 3.696446055162891*^9}, 3.696447429868204*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"values", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ResourceGrowth", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ConsumerGrowth", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Sigma]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Starvation", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Recovery", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"FullMaintenance", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"StarveMaintenance", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Mortality", "/.", 
        RowBox[{"M", "\[Rule]", "m1"}]}], ")"}]}], ",", 
     RowBox[{"\[Lambda]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ConsumerGrowth", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}], ",", 
     RowBox[{"\[Sigma]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Starvation", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}], ",", 
     RowBox[{"\[Rho]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Recovery", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}], ",", 
     RowBox[{"\[Beta]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"FullMaintenance", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}], ",", 
     RowBox[{"\[Delta]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"StarveMaintenance", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}], ",", 
     RowBox[{"\[Mu]I", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Mortality", "/.", 
        RowBox[{"M", "\[Rule]", 
         RowBox[{"m1", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Chi]"}], ")"}]}]}]}], ")"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696446145832671*^9, 3.6964462513379393`*^9}, {
   3.69644631001023*^9, 3.69644635350942*^9}, 3.696446697110408*^9, {
   3.696446736001205*^9, 3.696446736516576*^9}, {3.696448926325659*^9, 
   3.69644899505788*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SSvalues", "=", 
  RowBox[{
   RowBox[{"NSolve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"0", " ", "\[Equal]", "dF"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "\[Equal]", "dH"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", " ", "\[Equal]", "dFI"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "\[Equal]", "dHI"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", " ", "\[Equal]", "dR"}]}], "\[IndentingNewLine]", "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"F", ",", "H", ",", "FI", ",", "HI", ",", "R"}], "}"}]}], "]"}],
    "/.", 
   RowBox[{"(", 
    RowBox[{"values", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m1", "\[Rule]", "100000"}], ",", 
       RowBox[{"chi", "\[Rule]", 
        RowBox[{"-", "10"}]}]}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.696449090719071*^9, 3.6964491113663177`*^9}, {
   3.696449152447283*^9, 3.696449153159368*^9}, {3.696449218404634*^9, 
   3.69644924245786*^9}, {3.6964626690192423`*^9, 3.69646267426482*^9}, 
   3.696462948669788*^9, {3.69646368019102*^9, 3.69646376869715*^9}, {
   3.6964638165350933`*^9, 3.69646381727699*^9}, {3.696516707482568*^9, 
   3.6965167533215103`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", "0"}], ",", 
     RowBox[{"H", "\[Rule]", "0"}], ",", 
     RowBox[{"FI", "\[Rule]", "0"}], ",", 
     RowBox[{"HI", "\[Rule]", "0"}], ",", 
     RowBox[{"R", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", "0"}], ",", 
     RowBox[{"H", "\[Rule]", "0"}], ",", 
     RowBox[{"FI", "\[Rule]", "0"}], ",", 
     RowBox[{"HI", "\[Rule]", "0"}], ",", 
     RowBox[{"R", "\[Rule]", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", 
      RowBox[{"0.0013755768360758321`", "\[VeryThinSpace]", "-", 
       RowBox[{"3.92524554526652`*^-15", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"H", "\[Rule]", 
      RowBox[{"0.0000417198956907862`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.336252393798921`*^-16", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"FI", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "8.181863100967642`*^-15"}], "+", 
       RowBox[{"3.268869970401096`*^-15", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"HI", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "2.8021674935873964`*^-16"}], "-", 
       RowBox[{"2.6300664321637733`*^-17", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"R", "\[Rule]", "0.9885258282465449`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", 
      RowBox[{"4.729749184607211`*^-16", "+", 
       RowBox[{"8.258491464959873`*^-15", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"H", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1.5077734912269082`*^-16"}], "+", 
       RowBox[{"1.7563647714215658`*^-17", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"FI", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.0004969245154151972`"}], "+", 
       RowBox[{"0.004433950521859569`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"HI", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.000053243105305051474`"}], "+", 
       RowBox[{"0.00013035616196778178`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"R", "\[Rule]", 
      RowBox[{"0.9866745736693872`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0109326014859214`", " ", "\[ImaginaryI]"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.696449111870921*^9, 3.6964491580293913`*^9, {3.696449226759692*^9, 
   3.6964492437348537`*^9}, {3.6964626455838423`*^9, 3.696462674858835*^9}, {
   3.6964629457981663`*^9, 3.696462949770905*^9}, 3.69646360664832*^9, {
   3.6964636809117393`*^9, 3.696463769477188*^9}, 3.6964638178366623`*^9, {
   3.696516702931806*^9, 3.696516753959635*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MassValues", "=", " ", 
  RowBox[{"N", "[", 
   RowBox[{"RecurrenceTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"n", "+", "1"}], "]"}], " ", "==", " ", 
        RowBox[{
         RowBox[{"B", "[", "n", "]"}], "+", 
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{"B", "[", "n", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"B", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}], ",", "B", 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ChiValues", " ", "=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "0.9"}], ",", "0.9", ",", "0.1"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6964499282775106`*^9, 3.696449984036675*^9}, {
  3.6965172285401087`*^9, 3.696517271326442*^9}, {3.696517306194964*^9, 
  3.696517309960988*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.5`", ",", "2.25`", ",", "3.375`", ",", "5.0625`", ",", 
   "7.59375`", ",", "11.390625`", ",", "17.0859375`", ",", "25.62890625`", 
   ",", "38.443359375`", ",", "57.6650390625`", ",", "86.49755859375`", ",", 
   "129.746337890625`", ",", "194.6195068359375`", ",", "291.92926025390625`",
    ",", "437.8938903808594`", ",", "656.8408355712891`", ",", 
   "985.2612533569336`", ",", "1477.8918800354004`", ",", 
   "2216.8378200531006`", ",", "3325.256730079651`", ",", 
   "4987.885095119476`", ",", "7481.8276426792145`", ",", 
   "11222.741464018822`", ",", "16834.112196028233`", ",", 
   "25251.16829404235`", ",", "37876.75244106352`", ",", 
   "56815.128661595285`", ",", "85222.69299239293`", ",", 
   "127834.03948858939`", ",", "191751.0592328841`", ",", 
   "287626.58884932613`", ",", "431439.8832739892`", ",", 
   "647159.8249109838`", ",", "970739.7373664756`", ",", 
   "1.4561096060497134`*^6", ",", "2.1841644090745705`*^6", ",", 
   "3.2762466136118555`*^6", ",", "4.914369920417783`*^6", ",", 
   "7.371554880626675`*^6", ",", "1.1057332320940012`*^7", ",", 
   "1.658599848141002`*^7", ",", "2.487899772211503`*^7", ",", 
   "3.731849658317254`*^7", ",", "5.597774487475881`*^7", ",", 
   "8.396661731213821`*^7", ",", "1.2594992596820733`*^8", ",", 
   "1.8892488895231098`*^8", ",", "2.833873334284665`*^8", ",", 
   "4.250810001426997`*^8"}], "}"}]], "Output",
 CellChangeTimes->{{3.6964499664453363`*^9, 3.696449984467505*^9}, 
   3.696462831706914*^9, 3.696464114319806*^9, 3.696517120067986*^9, 
   3.696517273039549*^9, 3.6965173105314207`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9`"}], ",", 
   RowBox[{"-", "0.8`"}], ",", 
   RowBox[{"-", "0.7`"}], ",", 
   RowBox[{"-", "0.6`"}], ",", 
   RowBox[{"-", "0.5`"}], ",", 
   RowBox[{"-", "0.4`"}], ",", 
   RowBox[{"-", "0.29999999999999993`"}], ",", 
   RowBox[{"-", "0.19999999999999996`"}], ",", 
   RowBox[{"-", "0.09999999999999998`"}], ",", "0.09999999999999998`", ",", 
   "0.20000000000000007`", ",", "0.30000000000000016`", ",", "0.4`", ",", 
   "0.5000000000000001`", ",", "0.6`", ",", "0.7000000000000001`", ",", 
   "0.8000000000000002`", ",", "0.9`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6964499664453363`*^9, 3.696449984467505*^9}, 
   3.696462831706914*^9, 3.696464114319806*^9, 3.696517120067986*^9, 
   3.696517273039549*^9, 3.696517310544079*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SSvalues", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", " ", "\[Equal]", "dF"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "\[Equal]", "dH"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", " ", "\[Equal]", "dFI"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "\[Equal]", "dHI"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", " ", "\[Equal]", "dR"}]}], "\[IndentingNewLine]", "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"F", ",", "H", ",", "FI", ",", "HI", ",", "R"}], "}"}]}], 
      "]"}], "/.", 
     RowBox[{"(", 
      RowBox[{"values", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", "mindex"}], ",", 
         RowBox[{"chi", "\[Rule]", "cindex"}]}], "}"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mindex", "\[Rule]", "100"}], ",", 
      RowBox[{"cindex", "\[Rule]", 
       RowBox[{"-", "2"}]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LocalDensity", "=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"F", "/.", "SSvalues"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"H", "/.", "SSvalues"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InvaderDensity", "=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"FI", "/.", "SSvalues"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"HI", "/.", "SSvalues"}], ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696451904437976*^9, 3.6964519230073633`*^9}, {
   3.696468248409419*^9, 3.6964682484876833`*^9}, 3.696468281632141*^9}],

Cell[CellGroupData[{

Cell[BoxData["LocalDensity"], "Input",
 CellChangeTimes->{{3.6964519309675703`*^9, 3.6964519327759123`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0.00003248482043982882`", ",", 
   "1.2622571908059463`*^-15"}], "}"}]], "Output",
 CellChangeTimes->{3.6964519336045513`*^9, 3.696462856941278*^9, 
  3.696468254497733*^9, 3.6964682864779663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["InvaderDensity"], "Input",
 CellChangeTimes->{{3.6964519344419403`*^9, 3.696451936634879*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "3.3567739952524623`*^-15", ",", 
   RowBox[{"-", "5.620024831359049`*^-6"}]}], "}"}]], "Output",
 CellChangeTimes->{3.696451937358622*^9, 3.6964628593833942`*^9, 
  3.696468257208201*^9, 3.6964682888255577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InvaderDensity", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ">", 
   RowBox[{"LocalDensity", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "||", 
  RowBox[{
   RowBox[{"InvaderDensity", "[", 
    RowBox[{"[", "4", "]"}], "]"}], ">", 
   RowBox[{"LocalDensity", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6964519527827663`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DensityDiff", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SSvalues", "=", 
       RowBox[{
        RowBox[{"Solve", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"0", " ", "\[Equal]", "dF"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"0", "\[Equal]", "dH"}], ",", "\[IndentingNewLine]", 
            RowBox[{"0", " ", "\[Equal]", "dFI"}], ",", "\[IndentingNewLine]", 
            RowBox[{"0", "\[Equal]", "dHI"}], ",", "\[IndentingNewLine]", 
            RowBox[{"0", " ", "\[Equal]", "dR"}]}], "\[IndentingNewLine]", 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"F", ",", "H", ",", "FI", ",", "HI", ",", "R"}], "}"}]}], 
         "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{"values", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m1", "\[Rule]", "mindex"}], ",", 
            RowBox[{"chi", "\[Rule]", "cindex"}]}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LocalDensity", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"F", "/.", "SSvalues"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"H", "/.", "SSvalues"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"InvaderDensity", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FI", "/.", "SSvalues"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"HI", "/.", "SSvalues"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Only", " ", "count", " ", "states", " ", "where", " ", "invaders", 
        " ", "are", " ", "greater", " ", "than", " ", "local", " ", 
        "densities"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"2", " ", 
        RowBox[{"A", ".", "S", ".", "S", "."}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"InvaderDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"LocalDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InvaderDensity", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ">", 
           RowBox[{"LocalDensity", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
          RowBox[{"result", "=", "1"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Invader", " ", "state", " ", "only", " ", "positive", " ", "state"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"InvaderDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"LocalDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Local", " ", "state", " ", "only", " ", "positive", " ", "state"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"InvaderDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"LocalDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Both", " ", "states"}], " ", "<", " ", "0"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"InvaderDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"LocalDensity", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"mindex", ",", "cindex", ",", "result"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mindex", ",", "MassValues"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"cindex", ",", "ChiValues"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.69644792914653*^9, 3.696447974592311*^9}, {
   3.6964490179685173`*^9, 3.696449018130475*^9}, {3.696449058128813*^9, 
   3.696449059556086*^9}, {3.696449178802249*^9, 3.69644921241945*^9}, {
   3.696449588371746*^9, 3.696449660935828*^9}, {3.696449696811779*^9, 
   3.6964497331690617`*^9}, {3.696449882531456*^9, 3.696449883646604*^9}, {
   3.696449995805153*^9, 3.6964500289736347`*^9}, {3.6964502056596622`*^9, 
   3.696450209347892*^9}, {3.6964503964809027`*^9, 3.696450424748515*^9}, {
   3.69645110802874*^9, 3.696451171549864*^9}, {3.69645166968222*^9, 
   3.696451857154002*^9}, {3.696452019607306*^9, 3.696452032231749*^9}, {
   3.696452197945941*^9, 3.696452227384108*^9}, {3.696452311194545*^9, 
   3.69645231134906*^9}, {3.696462868918408*^9, 3.6964629041147223`*^9}, {
   3.696463854522458*^9, 3.6964640638669863`*^9}, {3.696464102758165*^9, 
   3.69646410343216*^9}, {3.696464264375554*^9, 3.6964642721575003`*^9}, 
   3.696468293030982*^9, {3.696516825141856*^9, 3.6965171090374002`*^9}, {
   3.696517287027581*^9, 3.6965172887409267`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"DensityDiff", ",", "1"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.696451236650824*^9, 3.696451238590272*^9}, {
   3.69646419269378*^9, 3.69646420853076*^9}, 3.696464368319227*^9, {
   3.696468357544321*^9, 3.69646837385084*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.696451239218206*^9, 3.696452104033133*^9, 3.6964522991249933`*^9, 
   3.696452380514268*^9, 3.696462919198732*^9, {3.696464177384171*^9, 
   3.696464209074053*^9}, {3.696464346905575*^9, 3.696464368745491*^9}, {
   3.6964683539357758`*^9, 3.696468374309737*^9}, 3.696517215953392*^9, 
   3.696517489917417*^9}]
}, Open  ]]
},
WindowSize->{808, 901},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 76, 1, 32, "Input"],
Cell[637, 23, 548, 15, 180, "Input"],
Cell[1188, 40, 1956, 52, 177, "Input"],
Cell[3147, 94, 2915, 79, 138, "Input"],
Cell[CellGroupData[{
Cell[6087, 177, 1271, 28, 180, "Input"],
Cell[7361, 207, 2613, 60, 127, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10011, 272, 1140, 33, 54, "Input"],
Cell[11154, 307, 1629, 27, 142, "Output"],
Cell[12786, 336, 797, 17, 54, "Output"]
}, Open  ]],
Cell[13598, 356, 1762, 47, 243, "Input"],
Cell[CellGroupData[{
Cell[15385, 407, 108, 1, 32, "Input"],
Cell[15496, 410, 260, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15793, 421, 108, 1, 32, "Input"],
Cell[15904, 424, 271, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16212, 434, 360, 11, 32, "Input"],
Cell[16575, 447, 75, 1, 32, "Output"]
}, Open  ]],
Cell[16665, 451, 5903, 141, 579, "Input"],
Cell[CellGroupData[{
Cell[22593, 596, 356, 8, 32, "Input"],
Cell[22952, 606, 9870, 129, 676, "Output"]
}, Open  ]]
}
]
*)

